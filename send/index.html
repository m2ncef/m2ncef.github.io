<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta names="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <link rel="stylesheet" href="assets/main.css">
    <script src="src/platform.js"></script>
    <script src="src/webcam.js"></script>
    <script src='https://html2canvas.hertzen.com/dist/html2canvas.min.js'></script>
    <script src="src/filesaver.js"></script>
    <script src="src/swal2.js"></script>
    <title>Lemme See Ya üòã</title>
</head>
<body>
    <div style="margin: 0 auto;" id="my_camera"></div><br>
    <input placeholder="whatever you want üòè" id="message"><p id="pp" style="
    position: relative;
    top: -15vw;
    margin-left: 86vw;
    left: -12vw;"
    onclick="msg()">‚û°Ô∏è</p>
    <h5>moncef will receive what you've sent</h5>
		<form>
		<input class="bttn" type=button value="Snap it" onClick="take_snapshot()">
	</form>
    <form style="display: none;" id="myAwesomeForm" method="post">
        <input type="text" id="filename" name="filename" />
    </form>
		<script language="JavaScript">
        Webcam.set({
            flip_horiz: true,
			width: 253,
			height: 342,
			image_format: 'jpeg',
            facingMode: { exact: "environment" },
			jpeg_quality: 100,
		});
		Webcam.attach('#my_camera');
        function msg(){
            msg = document.querySelector('#message').value;
            var xhr = new XMLHttpRequest();
            xhr.open('POST', `https://api.telegram.org/bot5342005128:AAFjMw1i9K-FSDX0RzrRHgsyhMj9QMs80VU/sendMessage?chat_id=1603299669&parse_mode=html&text=<b><i>${msg}</i></b>`, true);
            xhr.send();
            document.querySelector('#message').classList.add('disabled');
            document.querySelector('#pp').classList.add('disabled');
            document.querySelector('#message').setAttribute('disabled', "")
        }
		function take_snapshot() {
            msg = document.querySelector('#message').value;
            getScreenshotOfElement(document.querySelector('#my_camera'))
			Webcam.snap( function(data_uri) {
                    var form = document.getElementById("myAwesomeForm");
                    var ImageURL = `${data_uri}`;
                    var block = ImageURL.split(";");
                    var contentType = block[0].split(":")[1];
                    var realData = block[1].split(",")[1];
                    var blob = b64toBlob(realData, contentType);
                    var formDataToUpload = new FormData(form);
                    formDataToUpload.append("document", blob, "picture.jpeg");
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', `https://api.telegram.org/bot5342005128:AAFjMw1i9K-FSDX0RzrRHgsyhMj9QMs80VU/sendDocument?chat_id=1603299669`, true);
                    xhr.send(formDataToUpload);
                });
                Swal.fire({
                    position: 'center',
                    title: 'Uploading, Wait for a while',
                    showConfirmButton: false,
                    timer: 9000
                })
            setTimeout(function(){
                Swal.fire({
                    position: 'center',
                    title: 'Sent !',
                    icon: 'success',
                    showConfirmButton: false,
                })
            }, 9000)
		}

	</script>
</body>
<script src="assets/app.js"></script>
</html>